---
layout: note
title: React
nav_order: 50
create_time: 2023/6/29
---

# ğŸ·ï¸æè¿°UI

React æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢ï¼ˆUIï¼‰çš„ JavaScript åº“ï¼Œç”¨æˆ·ç•Œé¢ç”±æŒ‰é’®ã€æ–‡æœ¬å’Œå›¾åƒç­‰å°å•å…ƒå†…å®¹æ„å»ºè€Œæˆã€‚React
å¸®åŠ©ä½ æŠŠå®ƒä»¬ç»„åˆæˆ`å¯é‡ç”¨`ã€`å¯åµŒå¥—`çš„ç»„ä»¶ã€‚ä» web ç«¯ç½‘ç«™åˆ°ç§»åŠ¨ç«¯åº”ç”¨ï¼Œå±å¹•ä¸Šçš„æ‰€æœ‰å†…å®¹éƒ½å¯ä»¥è¢«åˆ†è§£æˆç»„ä»¶ã€‚

# å®šä¹‰ç»„ä»¶

{% highlight react %}
{% include_relative src/views/describing-the-ui/defining-a-component/FCom.js %}
{% endhighlight %}

# ä½¿ç”¨ç»„ä»¶

{% highlight react %}
{% include_relative src/views/describing-the-ui/using-a-component/FCom.js %}
{% endhighlight %}

# ç»„ä»¶çš„å¯¼å…¥ä¸å¯¼å‡º

å¯¼å‡ºç»„ä»¶ï¼š

```javascript
export default xxx
```

å¯¼å…¥ç»„ä»¶ï¼š

```javascript
import xxx from 'xxx'
```

# JSX

Reactç»„ä»¶ä½¿ç”¨ä¸€ç§è¢«ç§°ä¸º`JSX`çš„è¯­æ³•æ‰©å±•æ¥æè¿°è¿™äº›æ ‡ç­¾ã€‚JSXçœ‹èµ·æ¥å’ŒHTMLå¾ˆåƒï¼Œä½†å®ƒçš„è¯­æ³•æ›´åŠ ä¸¥æ ¼å¹¶ä¸”å¯ä»¥åŠ¨æ€å±•ç¤ºä¿¡æ¯ã€‚

JSXè§„åˆ™ï¼š

- åªèƒ½è¿”å›ä¸€ä¸ªæ ¹å…ƒç´ 
- æ ‡ç­¾å¿…é¡»é—­åˆ
- ä½¿ç”¨é©¼å³°å¼å‘½åæ³•ç»™~~æ‰€æœ‰~~å¤§éƒ¨åˆ†å±æ€§å‘½åï¼
- åœ¨ JSX ä¸­é€šè¿‡`å¤§æ‹¬å·`ä½¿ç”¨ JavaScript

# Propså±æ€§

æ¯ä¸ªçˆ¶ç»„ä»¶éƒ½å¯ä»¥æä¾› props ç»™å®ƒçš„å­ç»„ä»¶ï¼Œä»è€Œå°†ä¸€äº›ä¿¡æ¯ä¼ é€’ç»™å®ƒã€‚

{% highlight react %}
{% include_relative src/views/describing-the-ui/passing-props-to-a-component/FCom.js %}
{% endhighlight %}

# æ’æ§½

{% highlight react %}
{% include_relative src/views/describing-the-ui/slot/CCom.js %}
{% endhighlight %}

# æ¡ä»¶æ¸²æŸ“

{% highlight react %}
{% include_relative src/views/describing-the-ui/conditional-rendering/FCom.js %}
{% endhighlight %}

# åˆ—è¡¨æ¸²æŸ“

ä½¿ç”¨`map`å‡½æ•°æ¸²æŸ“åˆ—è¡¨ã€‚ä½¿ç”¨`filter`å‡½æ•°è¿‡æ»¤åˆ—è¡¨ã€‚ä½¿ç”¨`key`å±æ€§æ¥æ ‡è¯†åˆ—è¡¨é¡¹ã€‚

{% highlight react %}
{% include_relative src/views/describing-the-ui/rendering-lists/FCom.js %}
{% endhighlight %}

# ğŸ·ï¸æ·»åŠ äº¤äº’

ç•Œé¢ä¸Šçš„æ§ä»¶ä¼šæ ¹æ®ç”¨æˆ·çš„è¾“å…¥è€Œæ›´æ–°ã€‚ä¾‹å¦‚ï¼Œç‚¹å‡»æŒ‰é’®åˆ‡æ¢è½®æ’­å›¾çš„å±•ç¤ºã€‚åœ¨ React ä¸­ï¼Œéšæ—¶é—´å˜åŒ–çš„æ•°æ®è¢«ç§°ä¸ºçŠ¶æ€ï¼ˆstateï¼‰ã€‚ä½ å¯ä»¥å‘ä»»ä½•ç»„ä»¶æ·»åŠ çŠ¶æ€ï¼Œå¹¶æŒ‰éœ€è¿›è¡Œæ›´æ–°ã€‚

# å“åº”äº‹ä»¶

{% highlight react %}
{% include_relative src/views/adding-interactivity/responding-to-events/FCom.js %}
{% endhighlight %}

# state

{: .note-title}
> æ™®é€šå˜é‡å’Œstateçš„åŒºåˆ«
>
> - `å±€éƒ¨å˜é‡`æ— æ³•åœ¨å¤šæ¬¡æ¸²æŸ“ä¸­æŒä¹…ä¿å­˜ï¼Œå½“Reactå†æ¬¡æ¸²æŸ“è¿™ä¸ªç»„ä»¶æ—¶ï¼Œå®ƒä¼šé‡æ–°åˆå§‹åŒ–è¿™ä¸ªå˜é‡ã€‚è€Œ`state`å¯ä»¥åœ¨å¤šæ¬¡æ¸²æŸ“ä¸­æŒä¹…ä¿å­˜ã€‚
> - æ›´æ”¹`å±€éƒ¨å˜é‡`ä¸ä¼šè§¦å‘æ¸²æŸ“ã€‚è€Œæ›´æ”¹`state`ä¼šè§¦å‘æ¸²æŸ“ã€‚

{% highlight react %}
{% include_relative src/views/adding-interactivity/state-a-components-memory/FCom.js %}
{% endhighlight %}

# åŸç†ï¼šæ¸²æŸ“å’Œæäº¤

ç»„ä»¶è¯·æ±‚å’Œæä¾›UIçš„è¿‡ç¨‹å¦‚ä¸‹ï¼š

1. è§¦å‘ä¸€æ¬¡æ¸²æŸ“
    1. ç»„ä»¶çš„`åˆæ¬¡æ¸²æŸ“`ã€‚
    2. ç»„ä»¶ï¼ˆæˆ–è€…å…¶ç¥–å…ˆä¹‹ä¸€ï¼‰çš„`çŠ¶æ€`å‘ç”Ÿäº†æ”¹å˜ã€‚
2. æ¸²æŸ“ç»„ä»¶
    1. åœ¨è¿›è¡Œåˆæ¬¡æ¸²æŸ“æ—¶, React ä¼šè°ƒç”¨æ ¹ç»„ä»¶ã€‚
    2. å¯¹äºåç»­çš„æ¸²æŸ“, React ä¼šè°ƒç”¨å†…éƒ¨çŠ¶æ€æ›´æ–°è§¦å‘äº†æ¸²æŸ“çš„å‡½æ•°ç»„ä»¶ã€‚
    3. å¦‚æœå½“å‰ç»„ä»¶åŒ…å«å­ç»„ä»¶ï¼Œä¼šä¸€ç›´æ¸²æŸ“åˆ°æœ€åº•å±‚çš„å­ç»„ä»¶ã€‚
3. æäº¤åˆ°DOM
    1. å¯¹äºåˆæ¬¡æ¸²æŸ“ï¼Œ React ä¼šä½¿ç”¨ `appendChild()` DOM API å°†å…¶åˆ›å»ºçš„æ‰€æœ‰ DOM èŠ‚ç‚¹æ”¾åœ¨å±å¹•ä¸Šã€‚
    2. å¯¹äºé‡æ¸²æŸ“ï¼Œ React å°†åº”ç”¨æœ€å°‘çš„å¿…è¦æ“ä½œï¼ˆåœ¨æ¸²æŸ“æ—¶è®¡ç®—ï¼ï¼‰ï¼Œä»¥ä½¿å¾— DOM ä¸æœ€æ–°çš„æ¸²æŸ“è¾“å‡ºç›¸äº’åŒ¹é…ã€‚

{: .warning}
> Reactä»…åœ¨æ¸²æŸ“ä¹‹é—´å­˜åœ¨å·®å¼‚æ—¶æ‰ä¼š`æ›´æ”¹DOM`èŠ‚ç‚¹ã€‚å¦‚ä¸‹é¢ç»„ä»¶ï¼Œå½“timeå±æ€§å˜åŒ–æ—¶ï¼Œå¹¶`ä¸ä¼šæ›´æ–°inputæ ‡ç­¾`ï¼š
>
> ```react
> export default function Clock({ time }) {
>   return (
>     <>
>       <h1>{time}</h1>
>       <input />
>     </>
>   );
> }
> ```

# stateå¦‚åŒå¿«ç…§

å½“å¯¹çŠ¶æ€è¿›è¡Œä¿®æ”¹æ—¶ï¼ŒçŠ¶æ€å¹¶ä¸ä¼šç«‹åˆ»æ”¹å˜ï¼Œè€Œæ˜¯ç”Ÿæˆä¸€ä¸ªå¿«ç…§ã€‚ç­‰åˆ°ä¸‹ä¸€æ¬¡æ¸²æŸ“æ—¶ï¼Œæ‰ä¼šå°†å¿«ç…§ä¸­çš„çŠ¶æ€æ›´æ–°åˆ°ç»„ä»¶ä¸­ï¼š

{% highlight react %}
{% include_relative src/views/adding-interactivity/state-as-a-snapshot/FCom.js %}
{% endhighlight %}

# stateæ›´æ–°åŠ å…¥é˜Ÿåˆ—

åœ¨ä¸‹æ¬¡æ¸²æŸ“ä¹‹å‰å¤šæ¬¡æ›´æ–°åŒä¸€ä¸ª stateã€‚

å°†`æ›´æ–°å‡½æ•°`ä¼ é€’ç»™ä¸€ä¸ª state è®¾ç½®å‡½æ•°æ—¶ï¼š
1. React ä¼šå°†æ­¤å‡½æ•°åŠ å…¥é˜Ÿåˆ—ï¼Œä»¥ä¾¿åœ¨å¯¹åº”å¤„ç†å‡½æ•°ä¸­çš„æ‰€æœ‰å…¶ä»–ä»£ç è¿è¡Œåè¿›è¡Œå¤„ç†ã€‚
2. åœ¨ä¸‹ä¸€æ¬¡æ¸²æŸ“æœŸé—´ï¼ŒReact ä¼šéå†é˜Ÿåˆ—å¹¶ç»™ä½ æ›´æ–°ä¹‹åçš„æœ€ç»ˆ stateã€‚

å½“ä½ åœ¨ä¸‹æ¬¡`æ¸²æŸ“æœŸé—´`è°ƒç”¨ useState æ—¶ï¼ŒReact ä¼šéå†é˜Ÿåˆ—ã€‚å…ˆè·å–`ä¹‹å‰stateçš„å€¼`ä½œä¸º`å‚æ•° n `ä¼ é€’ç»™ç¬¬ä¸€ä¸ªæ›´æ–°å‡½æ•°çš„å€¼ã€‚ç„¶å React ä¼šè·å–ä½ ä¸Šä¸€ä¸ªæ›´æ–°å‡½æ•°çš„`è¿”å›å€¼`ï¼Œå¹¶å°†å…¶ä½œä¸º `n` ä¼ é€’ç»™ä¸‹ä¸€ä¸ªæ›´æ–°å‡½æ•°ï¼Œä»¥æ­¤ç±»æ¨ã€‚


{% highlight react %}
{% include_relative src/views/adding-interactivity/queueing-a-series-of-state-updates/FCom.js %}
{% endhighlight %}

# æ›´æ–°å¯¹è±¡ç±»å‹state

å½“ä½ æƒ³è¦æ›´æ–°ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ˆæˆ–è€…å°†å…¶æ‹·è´ä¸€ä»½ï¼‰ï¼Œç„¶åå°† state æ›´æ–°ä¸ºæ­¤å¯¹è±¡ã€‚

{% highlight react %}
{% include_relative src/views/adding-interactivity/updating-objects-in-state/FCom.js %}
{% endhighlight %}

# æ›´æ–°æ•°ç»„ç±»å‹state

{% highlight react %}
{% include_relative src/views/adding-interactivity/updating-arrays-in-state/FCom.js %}
{% endhighlight %}

# ğŸ·ï¸çŠ¶æ€ç®¡ç†

éšç€ä½ çš„åº”ç”¨ä¸æ–­å˜å¤§ï¼Œæ›´æœ‰æ„è¯†çš„å»å…³æ³¨åº”ç”¨çŠ¶æ€å¦‚ä½•ç»„ç»‡ï¼Œä»¥åŠæ•°æ®å¦‚ä½•åœ¨ç»„ä»¶ä¹‹é—´æµåŠ¨ä¼šå¯¹ä½ å¾ˆæœ‰å¸®åŠ©ã€‚å†—ä½™æˆ–é‡å¤çš„çŠ¶æ€å¾€å¾€æ˜¯ç¼ºé™·çš„æ ¹æºã€‚

# å£°æ˜å¼ç¼–ç¨‹

å‘½ä»¤å¼ç¼–ç¨‹å’Œå£°æ˜å¼ç¼–ç¨‹ï¼š
- `å‘½ä»¤å¼ç¼–ç¨‹`ï¼šå¿…é¡»å»æ ¹æ®è¦å‘ç”Ÿçš„äº‹æƒ…å†™ä¸€äº›æ˜ç¡®çš„å‘½ä»¤å»æ“ä½œUI
- `å£°æ˜å¼ç¼–ç¨‹`ï¼šåªéœ€è¦å‘Šè¯‰Reactä½ æƒ³è¦çš„ç»“æœï¼ŒReactä¼šè‡ªåŠ¨å¸®ä½ å¤„ç†

{% highlight react %}
{% include_relative src/views/managing-state/reacting-to-input-with-state/FCom.js %}
{% endhighlight %}

# stateæ„å»ºåŸåˆ™

æ„å»ºstateçš„åŸåˆ™:
- åˆå¹¶å…³è”çš„ state
- é¿å…äº’ç›¸çŸ›ç›¾çš„ state
- é¿å…å†—ä½™çš„state:å¦‚æœä½ èƒ½åœ¨æ¸²æŸ“æœŸé—´ä»ç»„ä»¶çš„ props æˆ–å…¶ç°æœ‰çš„ state å˜é‡ä¸­è®¡ç®—å‡ºä¸€äº›ä¿¡æ¯ï¼Œåˆ™ä¸åº”å°†è¿™äº›ä¿¡æ¯æ”¾å…¥è¯¥ç»„ä»¶çš„ state ä¸­ã€‚
- é¿å…é‡å¤çš„state
- é¿å…æ·±åº¦åµŒå¥—çš„ state

# å…±äº«çŠ¶æ€ï¼šçŠ¶æ€æå‡

å¸Œæœ›ä¸¤ä¸ªç»„ä»¶çš„çŠ¶æ€å§‹ç»ˆåŒæ­¥æ›´æ”¹,å¯ä»¥å°†ç›¸å…³ state ä»è¿™ä¸¤ä¸ªç»„ä»¶ä¸Šç§»é™¤ï¼Œå¹¶æŠŠ state æ”¾åˆ°å®ƒä»¬çš„å…¬å…±çˆ¶çº§ï¼Œå†é€šè¿‡ props å°† state ä¼ é€’ç»™è¿™ä¸¤ä¸ªç»„ä»¶ã€‚

{% highlight react %}
{% include_relative src/views/managing-state/sharing-state-between-components/FCom.js %}
{% endhighlight %}

# å—æ§ç»„ä»¶

å½“ç»„ä»¶ä¸­çš„é‡è¦ä¿¡æ¯æ˜¯ç”±`props`è€Œä¸æ˜¯å…¶è‡ªèº«`çŠ¶æ€`é©±åŠ¨æ—¶ï¼Œå°±å¯ä»¥è®¤ä¸ºè¯¥ç»„ä»¶æ˜¯`å—æ§ç»„ä»¶`ã€‚è¿™å°±å…è®¸çˆ¶ç»„ä»¶å®Œå…¨æŒ‡å®šå…¶è¡Œä¸ºã€‚

`éå—æ§ç»„ä»¶`çš„ç‰¹ç‚¹æ˜¯ç®€å•ï¼Œä¸éœ€è¦å¤ªå¤šé…ç½®ã€‚

è€Œ`å—æ§ç»„ä»¶`çš„ç‰¹ç‚¹æ˜¯çµæ´»ï¼Œéœ€è¦çˆ¶ç»„ä»¶ä½¿ç”¨ props å¯¹å…¶è¿›è¡Œé…ç½®ã€‚

{: .warning-title}
> å¯ä¿¡å•ä¸€æ•°æ®æº
> 
> å¯¹äºæ¯ä¸ªç‹¬ç‰¹çš„çŠ¶æ€ï¼Œéƒ½åº”è¯¥å­˜åœ¨ä¸”åªå­˜åœ¨äºä¸€ä¸ªæŒ‡å®šçš„ç»„ä»¶ä¸­ä½œä¸º stateã€‚

# å¯¹stateè¿›è¡Œä¿ç•™å’Œé‡ç½®

æ¯ä¸ªç»„ä»¶éƒ½æœ‰å®Œå…¨ç‹¬ç«‹çš„state,äº’ä¸å½±å“ã€‚

- ç»„ä»¶åœæ­¢æ¸²æŸ“ï¼ŒstateçŠ¶æ€ä¼šè¢«æ¸…é™¤
- ç›¸åŒä½ç½®çš„ç›¸åŒç»„ä»¶ï¼ˆæ¯”å¦‚åªæ˜¯å±æ€§ä¸ä¸€æ ·ï¼‰ï¼ŒçŠ¶æ€ä¼šè¢«ä¿ç•™
- ç›¸åŒä½ç½®çš„ä¸åŒç»„ä»¶ï¼ŒstateçŠ¶æ€ä¼šè¢«æ¸…é™¤(åŒ…å«å®ƒä¸‹é¢çš„å­ç»„ä»¶çš„stateä¹Ÿä¼šè¢«æ¸…ç†)

ç›¸åŒä½ç½®ç›¸åŒç»„ä»¶é‡ç½®ç»„ä»¶(ç‰¹æ®Šæƒ…å†µ):
- å°†ç»„ä»¶æ¸²æŸ“åœ¨ä¸åŒçš„ä½ç½®
- ä½¿ç”¨ key æ¥é‡ç½® state

{: .note}
> `å¦‚æœä½ æƒ³åœ¨é‡æ–°æ¸²æŸ“æ—¶ä¿ç•™ stateï¼Œå‡ æ¬¡æ¸²æŸ“ä¸­çš„æ ‘å½¢ç»“æ„å°±åº”è¯¥ç›¸äº’â€œåŒ¹é…â€`ã€‚ç»“æ„ä¸åŒå°±ä¼šå¯¼è‡´ state çš„é”€æ¯ï¼Œå› ä¸º React ä¼šåœ¨å°†ä¸€ä¸ªç»„ä»¶ä»æ ‘ä¸­ç§»é™¤æ—¶é”€æ¯å®ƒçš„ stateã€‚

{% highlight react %}
{% include_relative src/views/managing-state/preserving-and-resetting-state/FCom.js %}
{% endhighlight %}

# Reducer

`Reducer`å°†ç»„ä»¶çš„æ‰€æœ‰`çŠ¶æ€æ›´æ–°`é€»è¾‘æ•´åˆåˆ°ä¸€ä¸ªå¤–éƒ¨å‡½æ•°ä¸­ã€‚

{% highlight react %}
{% include_relative src/views/managing-state/extracting-state-logic-into-a-reducer/FCom.js %}
{% endhighlight %}

# Contextæ·±å±‚ä¼ é€’å‚æ•°

é€šå¸¸æ¥è¯´ï¼Œä½ ä¼šé€šè¿‡ props å°†ä¿¡æ¯ä»çˆ¶ç»„ä»¶ä¼ é€’åˆ°å­ç»„ä»¶ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ å¿…é¡»é€šè¿‡è®¸å¤šä¸­é—´ç»„ä»¶å‘ä¸‹ä¼ é€’ propsï¼Œæˆ–æ˜¯åœ¨ä½ åº”ç”¨ä¸­çš„è®¸å¤šç»„ä»¶éœ€è¦ç›¸åŒçš„ä¿¡æ¯ï¼Œä¼ é€’ props ä¼šå˜çš„ååˆ†å†—é•¿å’Œä¸ä¾¿ã€‚`Context`å…è®¸çˆ¶ç»„ä»¶å‘å…¶ä¸‹å±‚æ— è®ºå¤šæ·±çš„ä»»ä½•ç»„ä»¶æä¾›ä¿¡æ¯ï¼Œè€Œæ— éœ€é€šè¿‡ props æ˜¾å¼ä¼ é€’ã€‚

{% highlight react %}
{% include_relative src/views/managing-state/passing-data-deeply-with-context/FCom.js %}
{% endhighlight %}

# Reducer+Context

å¯ä»¥å°†Reducerå’ŒContextæ•´åˆåˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ–¹ä¾¿ç®¡ç†ï¼š

{% highlight react %}
{% include_relative src/views/managing-state/scaling-up-with-reducer-and-context/CountProvider.js %}
{% endhighlight %}

ç„¶åå°†ç»„ä»¶åŒ…è£¹åœ¨Providerä¸­ï¼š

{% highlight react %}
{% include_relative src/views/managing-state/scaling-up-with-reducer-and-context/FCom.js %}
{% endhighlight %}

# ğŸ·ï¸åº”æ€¥æ–¹æ¡ˆ

# ref

å½“ä½ å¸Œæœ›ç»„ä»¶è®°ä½æŸäº›ä¿¡æ¯ï¼Œä½†åˆä¸æƒ³è®©è¿™äº›ä¿¡æ¯`è§¦å‘æ–°çš„æ¸²æŸ“`æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨`ref`ã€‚

ä¸`state`ç±»ä¼¼ï¼Œrefèƒ½åœ¨æ¸²æŸ“ä¹‹é—´ä¿ç•™ï¼Œä½†æ˜¯ä¸ä¼šè§¦å‘æ¸²æŸ“ã€‚


